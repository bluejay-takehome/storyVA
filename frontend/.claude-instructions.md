# Claude Instructions for ShipFast (Next.js 15 + Tailwind v4 + DaisyUI v5)

## 🎯 Primary Objective
Maintain a warning-free, modern ShipFast codebase using the latest technologies while following best practices.

## 🚨 Critical Warning Elimination Rules

### 1. **Async Cookies Warning Fix**
**Problem**: `Route "/dashboard" used cookies().getAll(). cookies() should be awaited`

**Solution Pattern**:
```javascript
// ❌ CAUSES WARNING
const cookieStore = cookies();
return cookieStore.getAll();

// ✅ FIXES WARNING  
const cookieStore = await cookies();
return cookieStore.getAll();
```

**Action Required**: Always await `cookies()` and `headers()` in Next.js 15+

### 2. **Unused Import Warning Fix**
**Problem**: `'createClient' is defined but never used`

**Solution Pattern**:
```javascript
// ❌ CAUSES WARNING
import { createClient } from "@/libs/supabase/server";
// const supabase = createClient(); // commented out

// ✅ FIXES WARNING - Remove unused import
import { NextResponse } from "next/server";
// If needed later, move import inside comment:
// const { createClient } = require("@/libs/supabase/server");
```

### 3. **React Hook Dependency Warning Fix**  
**Problem**: `React Hook useEffect has a missing dependency: 'supabase.auth'`

**Solution Pattern**:
```javascript
// ❌ CAUSES WARNING
const supabase = createClient();
useEffect(() => {
  supabase.auth.getUser();
}, []); // Missing supabase dependency

// ✅ FIXES WARNING - Move supabase inside useEffect
useEffect(() => {
  const supabase = createClient();
  supabase.auth.getUser();
}, []); // No external dependencies
```

### 4. **Supabase Edge Runtime Warnings**
**Problem**: `A Node.js API is used (process.versions) which is not supported in the Edge Runtime`

**Solution**: These are harmless warnings from Supabase's realtime module. To minimize them:

```javascript
// ✅ Use minimal Supabase client for edge functions
import { createClient } from '@supabase/supabase-js'

// Instead of importing full SSR package in edge contexts
const supabase = createClient(url, key, {
  auth: { persistSession: false }, // Reduces Node.js API usage
  realtime: { disabled: true }     // Disables realtime (main cause)
});
```

## 🔧 Code Transformation Patterns

### Server Component Pattern
```javascript
// ✅ CORRECT Server Component
export default async function ServerPage() {
  const supabase = await createClient(); // Always await
  const { data } = await supabase.from('table').select('*');
  
  return <div>{data?.map(item => <div key={item.id}>{item.name}</div>)}</div>;
}
```

### Client Component Pattern  
```javascript
"use client";
import { useState, useEffect } from "react";
import { createClient } from "@/libs/supabase/client"; // Different import

// ✅ CORRECT Client Component
export default function ClientComponent() {
  const [data, setData] = useState(null);
  
  useEffect(() => {
    const supabase = createClient(); // No await needed on client
    supabase.from('table').select('*').then(({ data }) => setData(data));
  }, []); // Clean dependency array
  
  return <div>{/* JSX */}</div>;
}
```

### API Route Pattern
```javascript
import { NextResponse } from "next/server";
import { createClient } from "@/libs/supabase/server";

// ✅ CORRECT API Route
export async function POST(req) {
  try {
    const supabase = await createClient(); // Always await
    const body = await req.json();
    
    // Always check environment variables
    if (!process.env.REQUIRED_VAR) {
      return NextResponse.json({ error: "Config error" }, { status: 500 });
    }
    
    return NextResponse.json({ success: true });
  } catch (error) {
    return NextResponse.json({ error: error.message }, { status: 500 });
  }
}
```

## 🎨 Styling Patterns (Tailwind v4 + DaisyUI v5)

### CSS File Structure
```css
/* ✅ CORRECT Tailwind v4 + DaisyUI v5 setup */
@import "tailwindcss";
@plugin "daisyui";

@theme {
  --color-brand: oklch(60% 0.2 280);
  --size-custom: 1.5rem;
}

/* Custom utilities */
@utility btn-custom {
  background: var(--color-brand);
  padding: 0.5rem 1rem;
}

/* Pseudo-selectors as separate rules */
.btn-custom:hover {
  filter: brightness(1.1);
}
```

### Component Styling
```html
<!-- ✅ CORRECT DaisyUI v5 classes -->
<div class="card card-border card-sm"> <!-- v5 syntax -->
<button class="btn btn-primary md:btn-lg"> <!-- Responsive modifiers -->
<div class="join">
  <button class="btn join-item">Button 1</button>
  <button class="btn join-item">Button 2</button>
</div>
```

## 🔍 Pre-Commit Checklist

When reviewing or writing code, ALWAYS verify:

1. **✅ No Async Warnings**
   - All `cookies()` and `headers()` calls are awaited
   - All `createClient()` calls in server components are awaited

2. **✅ No Import Warnings**  
   - Remove unused imports
   - Move imports inside comments if code is commented out

3. **✅ No Hook Warnings**
   - All useEffect dependencies are included or moved inside effect
   - No external variables in dependency arrays unless necessary

4. **✅ Environment Variables**
   - All env vars are checked before use
   - Fallbacks provided for missing vars

5. **✅ Error Handling**
   - Try-catch blocks around async operations
   - Proper HTTP status codes returned
   - User-friendly error messages

## 🚫 Never Do This

```javascript
// ❌ NEVER - Causes async warnings
const cookies = cookies();
const headers = headers();

// ❌ NEVER - Unused imports
import { unused } from "package";

// ❌ NEVER - Missing dependencies
useEffect(() => {
  externalVar.doSomething();
}, []); // Missing externalVar

// ❌ NEVER - Old Tailwind v3 syntax with v4
@tailwind base;
@tailwind components; 
@tailwind utilities;

// ❌ NEVER - Old DaisyUI v4 classes with v5
<div class="card-bordered"> <!-- Use card-border -->
<div class="card-compact"> <!-- Use card-sm -->
```

## 🎯 Success Metrics

A successful code change should result in:
- ✅ `npm run build` passes without errors
- ✅ No ESLint warnings in terminal
- ✅ No browser console warnings
- ✅ All functionality works as expected
- ✅ Code follows modern patterns (Next.js 15, React 19, Tailwind v4, DaisyUI v5)

## 🔄 Quick Fix Commands

```bash
# Check for issues
npm run build
npm run lint

# Auto-fix ESLint issues
npm run lint -- --fix

# Start clean development
rm -rf .next && npm run dev
```

Remember: This codebase is fully updated to the latest versions. Always use the new APIs and patterns, never fall back to deprecated approaches. 